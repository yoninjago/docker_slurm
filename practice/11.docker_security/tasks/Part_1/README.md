## Повышаем привилегии на сервере с использованием docker

Переходим в каталог `docker_course/practice/11.docker_security/tasks/Part_1`

В теоретической части мы узнали, что docker запускает демон от рута и что это небезопасно.  
Так же мы узнали, что важно своевременно обновлять ПО на серверах, потому что оно может содержать серьёзные уязвимости.  
Давайте на практике посмотрим, как это может помочь получить повышенные привилегии.  

## DISCLAIMER
Так как это образовательная задача у вас останется возможность войти под root через sudo.  
Это нужно, чтобы проверить себя и чтобы починить стенд, если что-то пойдет не так.  
Пожалуйста, не используйте пользователя root для решение задания, ведь тогда оно потеряет всякий смысл.  

### Используем привилегированный режим

Используя привилегированный режим контейнера нужно создать файл /priv с содержимым "PWND!"

### Используем уязвимость CVE-2019-5736 старой версии runc

Совершенно случайно на нашем сервере стоит очень старая версия docker и, что более важно, runc.  
Сама уязвимость детально описана вот тут: https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/  
А вот в этом репозитории есть proof of concept эксплуатации уязвимости https://github.com/Frichetten/CVE-2019-5736-PoC  
Мы подготовили для вас dockerfile, а вам нужно с помощью данной уязвимости создать файл /CVE с содержимым "PWND!"

#### Если вы случайно заменили runc чем-то не тем, то используйте данную команду, чтобы восстановить стенд в рабочее состояние.
Используйте следующие команды:
```
Правим репозиторий:
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sed -i 's/$releasever/7/g' /etc/yum.repos.d/docker-ce.repo

Запускаем команду:
sudo yum --enablerepo=docker-ce-stable reinstall containerd.io-1.2.0-3.el7 docker-ce-18.09.0-3.el7 docker-ce-cli-18.09.0-3.el7
```
Для восстановления стенда, если вы сломали runc

### Если всё сделали, запустите фаил check_me.sh, он проверит

#### Если совсем зашли в тупик

Ответ (один из его возможных вариантов) можно найти в этом же каталоге с кодом для задания - в папке `_answer`.
